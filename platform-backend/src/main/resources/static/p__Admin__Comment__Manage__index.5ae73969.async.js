"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[9411],{49485:function(be,U,t){t.r(U),t.d(U,{default:function(){return Pe}});var oe=t(19632),de=t.n(oe),ce=t(15009),j=t.n(ce),he=t(97857),a=t.n(he),me=t(99289),S=t.n(me),fe=t(5574),h=t.n(fe),d=t(67294),w=t(53025),s=t(42075),C=t(83622),Ce=t(2453),V=t(4393),f=t(34041),I=t(84567),H=t(55102),A=t(86250),x=t(71471),ve=t(66309),pe=t(67839),K=t(17788),z=t(76772);function je(T,y){return O.apply(this,arguments)}function O(){return O=S()(j()().mark(function T(y,D){return j()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",(0,z.request)("/admin/comment",a()({method:"GET",params:a()({},y)},D||{})));case 1:case"end":return p.stop()}},T)})),O.apply(this,arguments)}var xe=t(28411),R=t(59753),ye=t(91777),Ze=t(82061),ge=t(43471),Fe=t(27681),Y=t(59537),De=t(93410),Ee=t(19207),Be=t(96074),e=t(85893),Se=function(y){var D=y.open,i=y.record,p=y.onCancel;return(0,e.jsx)(K.Z,{title:"\u8BC4\u8BBA\u8BE6\u60C5",open:D,onCancel:function(){p()},width:"80%",footer:!1,children:(0,e.jsx)(De.Z,{children:(0,e.jsxs)(s.Z,{direction:"vertical",style:{width:"100%"},children:[(0,e.jsx)(C.ZP,{type:"link",style:{padding:0},children:(0,e.jsxs)(z.Link,{to:"/api/info/".concat(i.apiId),children:["API\uFF1A",i.apiName]})}),(0,e.jsxs)(A.Z,{justify:"space-between",children:[(0,e.jsxs)(x.Z.Title,{level:4,children:[i.userNickname,"@ ",i.username]}),i.score!==void 0&&i.score!==0&&(0,e.jsxs)("div",{children:["\u8BC4\u5206\uFF1A",(0,e.jsx)(Ee.Z,{allowHalf:!0,disabled:!0,value:(0,Y.E)(i.score)}),"(",(0,Y.E)(i.score),")"]}),(i.score===void 0||i.score===0)&&(0,e.jsx)("div",{children:"\u65E0\u8BC4\u5206(\u4E0D\u662F\u5BF9API\u7684\u8BC4\u8BBA)"})]}),(0,e.jsxs)(x.Z.Paragraph,{children:["\u8BC4\u8BBA\u5185\u5BB9\uFF1A",i.content]}),(0,e.jsxs)(A.Z,{justify:"space-between",children:[(0,e.jsx)(s.Z,{direction:"horizontal",size:"large",children:(0,e.jsxs)(s.Z,{children:[(0,e.jsxs)("span",{children:["\u{1F44D} ",i.favorCount||0]}),(0,e.jsxs)("span",{children:["\u{1F4AC} ",i.replyCount||0]})]})}),(0,e.jsx)(x.Z.Text,{type:"secondary",children:(0,R.i$)(i.ctime)})]}),(0,e.jsx)(Be.Z,{}),(0,e.jsx)(x.Z.Title,{level:4,children:"\u6211\u7684\u56DE\u590D"}),!i.adminReplies&&"\u672A\u56DE\u590D",i.adminReplies&&(0,e.jsx)(s.Z,{direction:"vertical",style:{width:"100%"},children:i.adminReplies.map(function(E,$){return(0,e.jsxs)(s.Z,{direction:"vertical",style:{width:"100%"},children:[(0,e.jsx)(x.Z.Paragraph,{children:(0,R.i$)(E.ctime)}),(0,e.jsxs)(x.Z.Paragraph,{style:{marginLeft:20},children:["\u56DE\u590D\u5185\u5BB9\uFF1A",E.content]})]},E.id)})})]})})})},Ie=Se,Ae=t(90930),Re=5,Te=function(){var y=(0,d.useState)(!1),D=h()(y,2),i=D[0],p=D[1],E=(0,d.useState)([]),$=h()(E,2),ke=$[0],Me=$[1],we=(0,d.useState)([]),J=h()(we,2),Q=J[0],W=J[1],ze=(0,d.useState)(0),X=h()(ze,2),Oe=X[0],$e=X[1],Le=(0,d.useState)(1),b=h()(Le,2),L=b[0],P=b[1],Ne=(0,d.useState)({}),q=h()(Ne,2),o=q[0],c=q[1],Ge=(0,d.useState)({}),_=h()(Ge,2),g=_[0],B=_[1],Ue=(0,d.useState)(void 0),ee=h()(Ue,2),v=ee[0],N=ee[1],Ve=(0,d.useState)(),ne=h()(Ve,2),k=ne[0],te=ne[1],He=(0,d.useState)(!1),re=h()(He,2),ue=re[0],ae=re[1],Ke=(0,d.useState)(!1),ie=h()(Ke,2),le=ie[0],G=ie[1],Ye=w.Z.useForm(),Je=h()(Ye,1),M=Je[0];(0,d.useEffect)(function(){var r=!0;return(0,xe.Dk)().then(function(n){r&&n.code===0&&n.data&&Me(n.data)}),se(),function(){r=!1}},[]),(0,d.useEffect)(function(){se()},[L,g]);var se=function(){var r=S()(j()().mark(function n(){var u;return j()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return p(!0),l.prev=1,l.next=4,je(a()(a()({},g),{},{current:L}));case 4:u=l.sent,u.data&&(W(u.data.data||[]),$e(u.data.total||0));case 6:return l.prev=6,p(!1),l.finish(6);case 9:case"end":return l.stop()}},n,null,[[1,,6,9]])}));return function(){return r.apply(this,arguments)}}(),Qe=[{title:"id",dataIndex:"id",width:50},{title:"\u7528\u6237\u540D",dataIndex:"username",width:150,render:function(n){return(0,e.jsx)("div",{style:{whiteSpace:"normal",wordBreak:"break-word"},children:n})}},{title:"\u7528\u6237\u6635\u79F0",dataIndex:"userNickname",width:150,render:function(n){return(0,e.jsx)("div",{style:{whiteSpace:"normal",wordBreak:"break-word"},children:n})}},{title:"\u8BC4\u8BBA\u5185\u5BB9",dataIndex:"content",width:300,render:function(n){return(0,e.jsx)("div",{style:{whiteSpace:"normal",wordBreak:"break-word"},children:n})}},{title:"\u8BC4\u8BBA\u65F6\u95F4",dataIndex:"ctime",width:160,render:function(n){return(0,R.i$)(n)}},{title:"\u6211\u6709\u65E0\u56DE\u590D",dataIndex:"adminReplies",width:110,render:function(n){return n?"\u6709":"\u65E0"}},{title:"\u64CD\u4F5C",key:"action",width:150,render:function(n,u){return(0,e.jsxs)(s.Z,{direction:"horizontal",size:8,children:[(0,e.jsx)(C.ZP,{style:{padding:0},type:"link",color:"primary",onClick:function(){te(u),ae(!0)},children:"\u67E5\u770B"}),(0,e.jsx)(C.ZP,{style:{padding:0},type:"link",color:"primary",onClick:function(){te(u),G(!0)},children:"\u56DE\u590D"}),u.replyCount!==0&&(0,e.jsx)(C.ZP,{style:{padding:0},type:"link",color:"primary",onClick:function(){var l=a()({},o);l.username=void 0,l.isUserReply=void 0,l.isRoot=void 0,l.replyToCommentId=u.id,l.rootCommentId=void 0,N(u),c(l),P(1),B(l)},children:"\u6240\u6709\u56DE\u590D\u4FE1\u606F"}),(0,e.jsx)(C.ZP,{style:{padding:0},type:"link",color:"primary",onClick:S()(j()().mark(function Z(){var l;return j()().wrap(function(F){for(;;)switch(F.prev=F.next){case 0:return F.next=2,(0,Fe.YF)({id:u.id});case 2:if(l=F.sent,l.code===0){F.next=5;break}return F.abrupt("return");case 5:W(de()(Q.filter(function(Xe){return Xe.id!==u.id})));case 6:case"end":return F.stop()}},Z)})),children:(0,e.jsxs)("div",{children:["\u5220\u9664",(0,e.jsx)(Ze.Z,{style:{color:"red"}})]})})]})}}],We=function(){var r=S()(j()().mark(function n(){var u,Z;return j()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,M.validateFields();case 2:if(u=m.sent,k){m.next=5;break}return m.abrupt("return");case 5:return m.next=7,(0,ye.Hi)({apiId:k.apiId,replyToCommentId:k.id,content:u.content});case 7:if(Z=m.sent,Z.code===0){m.next=10;break}return m.abrupt("return");case 10:Ce.ZP.success("\u56DE\u590D\u6210\u529F"),G(!1),M.resetFields(),B(a()({},o));case 14:case"end":return m.stop()}},n)}));return function(){return r.apply(this,arguments)}}();return(0,e.jsx)(Ae._z,{title:!1,children:(0,e.jsxs)(V.Z,{children:[(0,e.jsxs)(s.Z,{direction:"vertical",style:{width:"100%",marginBottom:16},children:[(0,e.jsx)(f.Z,{style:{width:200},placeholder:"\u9009\u62E9API",value:o.apiId,allowClear:!0,onChange:function(n){return c(function(u){return a()(a()({},u),{},{apiId:n})})},children:ke.map(function(r){return(0,e.jsx)(f.Z.Option,{value:r.id,children:r.name},r.id)})}),(0,e.jsx)(I.Z,{checked:o.isRoot,onChange:function(n){N(void 0),c(function(u){return a()(a()({},u),{},{rootCommentId:void 0,replyToCommentId:void 0,replyToMe:void 0,excludeMe:void 0,isRoot:n.target.checked})})},children:"\u4EC5\u6839\u8BC4\u8BBA"}),(0,e.jsxs)(s.Z,{direction:"horizontal",children:[(0,e.jsx)(I.Z,{checked:o.replyToMe,onChange:function(n){return c(function(u){return a()(a()({},u),{},{replyToMe:n.target.checked})})},children:"\u56DE\u590D\u7ED9\u6211\u7684"}),(0,e.jsx)(I.Z,{checked:o.excludeMe,onChange:function(n){return c(function(u){return a()(a()({},u),{},{excludeMe:n.target.checked})})},children:"\u6392\u9664\u6211\u7684"})]}),(0,e.jsxs)(s.Z,{children:["\u7528\u6237\u540D\uFF1A",(0,e.jsx)(H.Z,{value:o.username,onChange:function(n){return c(function(u){return a()(a()({},u),{},{username:n.target.value?n.target.value:void 0})})}}),"\uFF08\u9ED8\u8BA4\u67E5\u8BE2\u7528\u6237\u8BC4\u8BBA\uFF09",(0,e.jsx)(I.Z,{checked:o.isUserReply,onChange:function(n){return c(function(u){return a()(a()({},u),{},{isUserReply:n.target.checked})})},children:"\u56DE\u590D\u7528\u6237\u7684\uFF08\u8054\u5408\u7528\u6237\u540D\u67E5\u8BE2\uFF09"})]}),(0,e.jsxs)(s.Z,{children:["\u6392\u5E8F\uFF1A",(0,e.jsxs)(f.Z,{value:o.ctime,style:{width:120},placeholder:"\u521B\u5EFA\u65F6\u95F4",allowClear:!0,onChange:function(n){return c(function(u){return a()(a()({},u),{},{ctime:n})})},children:[(0,e.jsx)(f.Z.Option,{value:!0,children:"\u5347\u5E8F"}),(0,e.jsx)(f.Z.Option,{value:!1,children:"\u964D\u5E8F"})]}),(0,e.jsxs)(f.Z,{value:o.favorCount,style:{width:120},placeholder:"\u70B9\u8D5E\u6570",allowClear:!0,onChange:function(n){return c(function(u){return a()(a()({},u),{},{favorCount:n})})},children:[(0,e.jsx)(f.Z.Option,{value:!0,children:"\u5347\u5E8F"}),(0,e.jsx)(f.Z.Option,{value:!1,children:"\u964D\u5E8F"})]}),(0,e.jsxs)(f.Z,{value:o.replyCount,style:{width:120},placeholder:"\u56DE\u590D\u6570",allowClear:!0,onChange:function(n){return c(function(u){return a()(a()({},u),{},{replyCount:n})})},children:[(0,e.jsx)(f.Z.Option,{value:!0,children:"\u5347\u5E8F"}),(0,e.jsx)(f.Z.Option,{value:!1,children:"\u964D\u5E8F"})]})]}),(0,e.jsx)(A.Z,{justify:"end",children:(0,e.jsxs)(s.Z,{children:[(0,e.jsx)(C.ZP,{onClick:function(){B(a()({},o))},children:(0,e.jsx)(ge.Z,{})}),(0,e.jsx)(C.ZP,{onClick:function(){N(void 0),c(function(n){return{rootCommentId:void 0,replyToCommentId:void 0}})},children:"\u6E05\u9664\u5F53\u524D\u8BC4\u8BBA"}),(0,e.jsx)(C.ZP,{onClick:function(){c(function(n){return{rootCommentId:n.rootCommentId,replyToCommentId:n.replyToCommentId}})},children:"\u6E05\u7A7A\u67E5\u8BE2\u6761\u4EF6"}),(0,e.jsx)(C.ZP,{variant:"solid",color:"primary",onClick:function(){P(1),B(a()({},o))},children:"\u67E5\u8BE2"})]})})]}),v&&(0,e.jsxs)(s.Z,{direction:"vertical",style:{color:"red"},children:[g.rootCommentId&&(0,e.jsxs)("div",{children:["\u5F53\u524D\u662F id= ",g.rootCommentId," \u7684\u6240\u6709\u8BC4\u8BBA"]}),g.replyToCommentId&&(0,e.jsxs)("div",{children:["\u5F53\u524D\u662F id= ",g.replyToCommentId," \u7684\u6240\u6709\u56DE\u590D"]}),(0,e.jsxs)(A.Z,{align:"end",children:[(0,e.jsx)(V.Z,{style:{marginLeft:20,marginBottom:10},children:(0,e.jsxs)(s.Z,{direction:"vertical",children:[(0,e.jsxs)(x.Z.Paragraph,{type:"secondary",children:["@",v.userNickname,"\uFF1A",v.content]}),(0,e.jsxs)(s.Z,{children:[(0,e.jsx)(z.Link,{to:"/api/info/".concat(v.apiId),children:(0,e.jsx)(ve.Z,{color:"cyan",children:v.apiName})}),(0,e.jsx)(s.Z,{direction:"horizontal",size:"large",children:(0,e.jsxs)(s.Z,{children:[(0,e.jsxs)("span",{children:["\u{1F44D} ",v.favorCount||0]}),(0,e.jsxs)("span",{children:["\u{1F4AC} ",v.replyCount||0]})]})}),(0,e.jsx)(x.Z.Text,{type:"secondary",children:(0,R.i$)(v.ctime)})]})]})}),(0,e.jsx)("div",{style:{marginLeft:20,marginBottom:10},children:!g.replyToCommentId&&(0,e.jsx)(C.ZP,{disabled:v.replyCount===0,color:"primary",onClick:function(){var n=a()({},o);n.username=void 0,n.isUserReply=void 0,n.isRoot=void 0,n.replyToCommentId=v.id,n.rootCommentId=void 0,c(n),P(1),B(n)},children:"\u6240\u6709\u56DE\u590D\u4FE1\u606F"})})]})]}),(0,e.jsx)(pe.Z,{columns:Qe.map(function(r){return a()(a()({},r),{},{align:"center"})}),dataSource:Q,rowKey:"id",loading:i,pagination:{current:L,pageSize:Re,total:Oe,onChange:function(n,u){P(n)}}}),ue&&(0,e.jsx)(Ie,{open:ue,record:k,onCancel:function(){ae(!1)}}),le&&(0,e.jsx)(K.Z,{title:"\u56DE\u590D\u8BC4\u8BBA",open:le,onOk:We,onCancel:function(){G(!1),M.resetFields()},children:(0,e.jsx)(w.Z,{form:M,children:(0,e.jsx)(w.Z.Item,{name:"content",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u56DE\u590D\u5185\u5BB9"}],children:(0,e.jsx)(H.Z.TextArea,{rows:4,placeholder:"\u8BF7\u8F93\u5165\u56DE\u590D\u5185\u5BB9"})})})})]})})},Pe=Te}}]);
